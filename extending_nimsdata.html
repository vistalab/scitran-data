<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extending NIMSData &mdash; NIMSData  documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="NIMSData  documentation" href="index.html" />
    <link rel="prev" title="nimsdata package" href="nimsdata.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nimsdata.html" title="nimsdata package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">NIMSData  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="extending-nimsdata">
<h1>Extending NIMSData<a class="headerlink" href="#extending-nimsdata" title="Permalink to this headline">¶</a></h1>
<p>Support for additional varieties of data can be added by creating additional parsers and writers.  New parsers and
writers can be subclassed from the base nimsdata.NIMSReader and nimsdata.NIMSWriter, or from domain specific
base classes, such as nimsdata.medimg.MedImgReader and nimsdata.medimg.MedImgWriter.</p>
<div class="section" id="nimsdata-input-file-format">
<h2>NIMSdata input file format<a class="headerlink" href="#nimsdata-input-file-format" title="Permalink to this headline">¶</a></h2>
<p>The standard NIMSdata format is a .tar.gz/.tgz file.  The input .tar.gz/.tgz should contain metadata.json, and a
dataset. The json file, metadata.json, should be the first regular file in the archive. The metadata.json file should contain
at least one section sections, &#8216;filetype&#8217;, and may contain two additional sections, &#8216;header&#8217; and &#8216;overwrite&#8217;. Filetype
will be used to match the input file to it&#8217;s parser. The header section is used to define any metadata that is not naturally
part of the dataset.  For example, if a dataset does not contain anything that identifies the data, then identification information
can be added to the header section of metadata.json.  The overwrite section is used to overwrite metadata.  The overwrite section will
overwrite any metadata that is contained in the data, or in the header section of metadata.json.</p>
<div class="code json highlight-python"><div class="highlight"><pre><span class="p">{</span>
 <span class="s">&quot;filetype&quot;</span><span class="p">:</span> <span class="s">&quot;dicom&quot;</span><span class="p">,</span>
 <span class="s">&quot;header&quot;</span><span class="p">:</span>
        <span class="p">{</span>
        <span class="s">&quot;&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
        <span class="p">},</span>
 <span class="s">&quot;overwrite&quot;</span><span class="p">:</span>
        <span class="p">{</span>
        <span class="s">&quot;&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
        <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-new-nimsreader">
<h2>Creating a new NIMSReader<a class="headerlink" href="#creating-a-new-nimsreader" title="Permalink to this headline">¶</a></h2>
<p>The nimsdata.NIMSReader base class can be subclassed to created additional data readers.</p>
<p>A subclass of nimsdata.NIMSReader must implement the following:</p>
<blockquote>
<div><ul>
<li><p class="first">__init__ method:</p>
<p>the init method should call <cite>super</cite> to perform the parent class&#8217;s __init__ method, which will perform some setup.
The __init__ function should read one file from the tar archive, and parse metadata that can be collected from a
single file.  In cases where the input is several files, some information might not be parseable until all the
inputs have been read in.  __init__ should implement opening the tar archive, and streaming the first file into
a StringIO/ByteIO/cStringIO file like object in self._hdr.  __init__ should also parse necessary sorting
information.  __init__ should also be capable of assigning an unique ID to the file, some files may already have
unique IDs that can be used as the nims unique ID.</p>
<p>__init__ should invoke the parent class&#8217;s __init__.</p>
</li>
<li><p class="first">load_data method</p>
<p>load_data should read in all the data files contained within the input .tar.gz/.tgz.  This method should
parse metadata that requires multiple, or all, input files to be present.  This method should also convert
data into an intermediate format.</p>
</li>
<li><p class="first">nims_group_id property</p>
</li>
<li><p class="first">nims_project_property</p>
</li>
<li><p class="first">nims_session_id property</p>
</li>
<li><p class="first">nims_session_label property</p>
</li>
<li><p class="first">nims_session_subject property</p>
</li>
<li><p class="first">nims_acquisition_id property</p>
</li>
<li><p class="first">nims_acquisition_label property</p>
</li>
<li><p class="first">nims_acquisition_description property</p>
</li>
<li><p class="first">nims_file_name property</p>
</li>
<li><p class="first">nims_file_ext property</p>
</li>
<li><p class="first">nims_file_domain property</p>
</li>
<li><p class="first">nims_file_type property</p>
</li>
<li><p class="first">nims_file_kind property</p>
</li>
<li><p class="first">nims_file_state property</p>
</li>
<li><p class="first">nims_timestamp property</p>
</li>
<li><p class="first">nims_timezone property</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="creating-a-custom-nimswriter">
<h2>Creating a custom NIMSWriter<a class="headerlink" href="#creating-a-custom-nimswriter" title="Permalink to this headline">¶</a></h2>
<p>The nimsdata.NIMSWriter base class can be subclasses to create additional data readers.  New writer classes
should inherit from an abstract class whose implementation of write does not write to a file.  This is to
avoid accidentally writing a file by using <cite>super</cite>. Thus if you need to create multiple writers that share
a common setup, it is recommended to create an abstract base class to inherit from.</p>
<p>A subclass of nimsdata.NIMSWriter must implement the following:</p>
<blockquote>
<div><ul>
<li><p class="first">write classmethod:</p>
<p>The write class method should call super to perform the parent class&#8217;s write.</p>
</li>
</ul>
</div></blockquote>
<p>Other considerations:</p>
<blockquote>
<div><ul class="simple">
<li>NIMSWriter appends its own file extension.  It should accept a basename, without extention.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="creating-a-data-domain">
<h2>Creating a data domain<a class="headerlink" href="#creating-a-data-domain" title="Permalink to this headline">¶</a></h2>
<p>Readers and Writers can be grouped together based on their data domain.  A domain is similar to a scientific domain, such as
neuro-imaging or genetics.  Readers and writers in the same domain should have an intermediate format that allows &#8220;mix-and-matching&#8221;
of readers and writers within a domain.</p>
<p>Creating a new data domain involves sublcasses NIMSReader and NIMSWriter into new abstract base classes that define
additional properties, metadata and methods that will be shared within that data domain.</p>
<p>see nimsdata.medimg.medimg for an example of defining a data domain (domain is medical images).
See nimsdata.medimg.nimsdicom for an example of creating a specific reader for a daomain (read dicoms, within medical image domain).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Extending NIMSData</a><ul>
<li><a class="reference internal" href="#nimsdata-input-file-format">NIMSdata input file format</a></li>
<li><a class="reference internal" href="#creating-a-new-nimsreader">Creating a new NIMSReader</a></li>
<li><a class="reference internal" href="#creating-a-custom-nimswriter">Creating a custom NIMSWriter</a></li>
<li><a class="reference internal" href="#creating-a-data-domain">Creating a data domain</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nimsdata.html"
                        title="previous chapter">nimsdata package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/extending_nimsdata.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nimsdata.html" title="nimsdata package"
             >previous</a> |</li>
        <li><a href="index.html">NIMSData  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Author.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>